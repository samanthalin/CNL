<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="Context-Script-Type" content="text/javascript">
    <meta http-equiv="pragma" content="no-cache">

    <title>系統功能設定</title>
    <!-- HTTP 1.1 -->
    <meta http-equiv="Cache-Control" content="no-store" />
    <!-- HTTP 1.0 -->
    <meta http-equiv="Pragma" content="no-cache" />

    <!-- Prevents caching at the Proxy Server -->
    <meta http-equiv="Expires" content="0" />
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />

    <!-- For RWD Design -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="x-ua-compatible" content="IE=Edge">

    <!-- Icon -->
    <link rel="shortcut icon" href="../../images/chinalife_favicon.png" />
    <link rel="icon" type="image/png" href="../../images/chinalife_favicon.png">

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="../../css/default.css">

    <!-- for form validation -->
    <link rel="stylesheet" type="text/css" href="../../css/screen.css">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link rel="stylesheet" type="text/css" href="../../css/ie10-viewport-bug-workaround.css">

    <!-- for jQuery UI -->
    <link rel="stylesheet" type="text/css" href="../../css/themes/base/jquery.ui.all.css">

    <!-- for Bootstrap -->
    <link rel="stylesheet" type="text/css" href="../../css/bootstrap/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../../css/bootstrap/bootstrap-theme.min.css">

    <link rel="stylesheet" type="text/css" href="../../css/jquery.smartmenus.bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../../css/bootstrap/bootstrap-ext.css">

    <!-- for jQuery EasyUI -->
    <link rel="stylesheet" type="text/css" href="../../css/themes/chinalife/easyui.css">
    <!-- <link rel="stylesheet" type="text/css" href="../../css/themes/mobile.css"> -->
    <link rel="stylesheet" type="text/css" href="../../css/themes/icon.css">
    <link rel="stylesheet" type="text/css" href="../../css/easyui-ext.css">

    <link rel="stylesheet" type="text/css" href="../../css/select2.min.css">
    <link rel="stylesheet" type="text/css" href="../../css/select2-bootstrap.min.css">

    <link rel="stylesheet" type="text/css" href="../../css/common.css">


    <!-- Java Script -->
    <script type="text/javascript" src="../../js/menu04.js"></script>
    <script type="text/javascript" src="../../js/json3.min.js"></script>
    <script type="text/javascript" src="../../js/html5.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
<script type="text/javascript" src="../../js/html5shiv.min.js"></script>
<script type="text/javascript" src="../../js/respond.min.js"></script>
<![endif]-->

    <!-- For Jquery JavaScript Library -->
    <script type="text/javascript" src="../../js/jquery/jquery.min.js"></script>

    <script type="text/javascript" src="../../js/jqueryui/jquery.ui.core.js"></script>
    <script type="text/javascript" src="../../js/jqueryui/jquery.ui.widget.js"></script>
    <script type="text/javascript" src="../../js/jqueryui/jquery.ui.datepicker.js"></script>
    <script type="text/javascript" src="../../js/jqueryui/i18n/jquery.ui.datepicker-zh-TW.js"></script>

    <script type="text/javascript" src="../../js/jquery/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="../../js/jquery/easyui-lang-zh_TW.js"></script>
    <script type="text/javascript" src="../../js/jquery/jquery.easyui.ext.js"></script>
    <!-- <script type="text/javascript" src="../../js/jquery/jquery.easyui.mobile.js"></script> -->

    <script type="text/javascript" src="../../js/jquery/jquery.validate.min.js"></script>
    <script type="text/javascript" src="../../js/jquery/additional-methods.min.js"></script>
    <script type="text/javascript" src="../../js/jquery/messages_zh_TW.min.js"></script>

    <script type="text/javascript" src="../../js/jquery/jquery.base64.min.js"></script>
    <script type="text/javascript" src="../../js/jquery/jquery.placeholder.min.js"></script>
    <script type="text/javascript" src="../../js/jquery/select2.min.js"></script>
    <script type="text/javascript" src="../../js/jquery/jquery.cookie.js"></script>
    <script type="text/javascript" src="../../js/jquery/jquery.blockUI.js"></script>
    <script type="text/javascript" src="../../js/jquery/jquery.storageapi.min.js"></script>

    <script type="text/javascript" src="../../js/bootstrap.js"></script>
    <script type="text/javascript" src="../../js/jquery/jquery.smartmenus.min.js"></script>
    <script type="text/javascript" src="../../js/jquery/jquery.smartmenus.bootstrap.min.js"></script>

    <!-- for 中壽難字library -->
    <!-- <script type="text/javascript" src="../../js/hanlinks/wf.js"></script> -->

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script type="text/javascript" src="../../js/ie10-viewport-bug-workaround.js"></script>

    <script type="text/javascript" src="../../js/core/session.js"></script>
    <script type="text/javascript" src="../../js/utils.js"></script>


    <script type="text/javascript">
        //var $j = $j || jQuery.noConflict();

        $(document).ready(function() {
            // 共用變數區-------------------------------------------------------

            // 頁面初始化區 -----------------------------------------------------
            $('input[type=text], input[type=search], input[type=url], input[type=telephone], input[type=email], input[type=password]').attr('autocomplete', 'off');

            // 事件註冊區 -------------------------------------------------------
            $('.select2').on('change', function() {
                $(this).valid();
            });

        });

        /**
         * 取代default alert javascript，這個比較漂亮
         */
        function alert2(msg, title) {
            title = title || '提示';

            if (!msg) {
                msg = '';
            }

            $.messager.alert(title, msg);
        }

        /**
         * 停用 enter submit
         */
        $(document).keypress(function(e) {
            // if (e.keyCode == 13) { e.keyCode = 0; return false; }
        });

        /**
         * 預設所有jQuery AJAX Request發生Error時會呼叫此function
         */
        $(document).ajaxError(function(event, jqXHR, ajaxSettings, thrownError) {
            var status = jqXHR.status;

            if (status == '403') {
                alert('操作已逾時，系統即將登出');
                session.signOut();
            } else {
                alert('系統發生錯誤，請與系統管理人員聯絡');
            }
        });

        /**
         * 預設所有jQuery AJAX Request發送前會呼叫此function
         */
        $(document).ajaxSend(function(event, jqXHR, ajaxSettings) {
            // Timer重新計數
            if (resetTimeOutInterval) {
                resetTimeOutInterval(event);
            }

            // 新增CSRF Header -------------------------------------------------
            var token = $("meta[name='_csrf']").attr("content");
            var header = $("meta[name='_csrf_header']").attr("content");

            jqXHR.setRequestHeader(header, token);
        });

        $.extend($.validator.messages, {
            required: "此為必填欄位",
        });

        /**
         * 解決form validation在bootstrap中，當驗證錯誤時，若輸入欄位有加icon，會造成欄位破掉
         */
        $.validator.setDefaults({
            highlight: function(element, errorClass, validClass) {
                if (element.type === "radio") {
                    this.findByName(element.name).addClass(errorClass).removeClass(validClass);
                } else {
                    $(element).closest('.form-group').removeClass('has-success has-feedback').addClass('has-error has-feedback');
                }
            },
            unhighlight: function(element, errorClass, validClass) {
                if (element.type === "radio") {
                    this.findByName(element.name).removeClass(errorClass).addClass(validClass);
                } else {
                    $(element).closest('.form-group').removeClass('has-error has-feedback').addClass('has-success has-feedback');
                }
            },
            errorElement: 'span',
            errorClass: 'help-block',
            errorPlacement: function(error, element) {
                if (element.parent('.input-group').length) {
                    error.insertAfter(element.parent());
                } else if (element.parent('.radio-inline').length) {
                    error.insertAfter(element.parent().parent());
                } else if (element.hasClass('select2')) {
                    error.insertAfter(element.next('span'));
                } else {
                    error.insertAfter(element);
                }
            }
        });

    </script>

    <style type="text/css">
        /** 取代原本datepicker月下拉選單寬度，不調整的話中文會造成表格斷行 */
        
        .ui-datepicker select.ui-datepicker-month {
            font-size: 12px;
            width: 35%;
        }
        /** 取代原本datepicker年下拉選單寬度，不調整的話中文會造成表格斷行  */
        
        .ui-datepicker select.ui-datepicker-year {
            font-size: 12px;
            width: 40%;
        }
        /** select2 的下拉選單會跟著頁面大小resize */
        
        @media screen {
            .select2 {
                width: 100% !important;
            }
        }
        /** 設定select2驗證錯誤時的樣式 */
        
        .has-error .select2-selection {
            border: 1px solid #a94442;
            border-radius: 4px;
        }

    </style>




    <script type="text/javascript">
        $(document).ready(function() {
            // 共用變數區-------------------------------------------------------

            // 頁面初始化區 -----------------------------------------------------

            $('input[placeholder]').placeholder();
            $('#kaptchaValue').val('');

            $(':input:visible:eq(0)').focus().select();

            // 事件註冊區 -------------------------------------------------------
            $("#form").validate({
                rules: {
                    logInAccount: {
                        required: true
                    },
                    logInPw: {
                        required: true
                    },
                    kaptchaValue: {
                        required: true
                    }
                },
                messages: {

                }
            });

            $('#regenImgBt').click(function() { // 重新產生圖形驗證碼
                $('#kaptchaImg').attr('src', 'kaptcha.jpg');
            });

            $('#doLogInBt').click(function() {
                if (!$("#form").valid()) {
                    return false;
                }

            });
        });

    </script>

    <style type="text/css">
        body {
            padding-top: 40px;
            padding-bottom: 40px;
            background-color: #ffffff;
        }

    </style>
    <link rel="stylesheet" type="text/css" href="../../css/decorators.css">

    <script type="text/javascript">
        $(document).ready(function() {
            // 共用變數區-------------------------------------------------------
            var userAccount = 'user001';

            // 頁面初始化區 -----------------------------------------------------
            $.cookie("isSessionAlive", 'Y');
            if (userAccount) {
                setTimeOutInterval();
            }

            $('a[menuType="02"]').attr('target', '_blank'); // 02:項目(另開視窗)

            $('input:not(:disabled):not([readonly]):visible:eq(0)').focus().select();
            $('input[placeholder]').placeholder();

            // 事件註冊區 -------------------------------------------------------

            $('#logoutAnchor').click(function() {
                if (!confirm('確認登出?')) {
                    return;
                }
                $("#caslogoutForm").submit();
            });
        });

    </script>

    <style type="text/css">
        body {}

    </style>

    <!-- for 中壽難字library -->
    <script type="text/javascript" src="../../js/hanlinks/wf.js"></script>

    <script type="text/javascript">
        $(document).ready(function() {
            // 共用變數區-------------------------------------------------------

            // 頁面初始化區 -----------------------------------------------------
            $('#deptNoSel, #systemSel').select2({
                theme: "bootstrap"
            });

            // 事件註冊區 ------------------------------------------------------
            $('input[type=text]').blur(function() {
                $(this).val(trim($(this).val()));
            });

            $('#userAccount').blur(function() {
                $(this).val(toUpperCase($(this).val()));
            });

            $('#clrQryBt').click(function() {
                $('#form input[type=text]').val('');
                $('#accountSts').val('');
                $('#deptNoSel').val('').trigger('change.select2');
            });

            $('#doQryBt').click(function() {
                $('#addRoleDiv').addClass('hide');
                $('#qryRolesResultDiv').addClass('hide');

                doQryUserList();
            });

            $('#doUpdateBt').click(function() {
                alert2('更新成功!', '群組權限設定');
            });

            $('#systemSel').change(function() {
                doLoadMgrRole($(this).val());
            });

            $('#addRoleBt').click(function() {
                var systemSel = $('#systemSel').val();
                var roleUuid = $('#roleSel').val();
                var userUuid = $('#tmpUserUuid').val();

                if (isBlank(systemSel)) {
                    alert('請選擇應用系統');
                    return;
                }

                if (isBlank(roleUuid)) {
                    alert('請選擇系統角色');
                    return;
                }

                if (!confirm('確認新增角色?')) {
                    return;
                }

                $.ajax({
                    url: './F010001_SCN1.action?doAddUserRole',
                    data: {
                        roleUuid: roleUuid,
                        uuid: userUuid
                    },
                    type: 'POST',
                    async: false,
                    dataType: 'json',
                    success: function(json) {
                        if (isNotBlank(json.msg)) {
                            alert(json.msg);
                        }

                        if (json.action == 'Y') {
                            alert('角色已新增');

                            $('#qryRolesResultTb').datagrid('reload');
                        }
                    }
                });
            });
        });

        /**
         * 查詢使用者清單
         */
        function doQryUserList() {
            $.blockUI({
                message: '<img src="../../images/busy.gif" /> Please Wait...'
            });

            $('#qryResultTb').datagrid({
                url: null,
                width: '100%',
                title: '',
                height: 386,
                pageNumber: 1,
                pagination: false,
                rownumbers: true,
                singleSelect: true,
                showFooter: false,
                queryParams: {
                    userAccount: toUpperCase($('#userAccount').val()),
                    userId: $('#userId').val(),
                    userNm: $('#userNm').val(),
                    mobileNo: $('#mobileNo').val(),
                    deptNo: $('#deptNoSel').val(),
                    accountSts: $('#accountSts').val()
                },
                onLoadError: function() {
                    $.unblockUI();
                },
                onBeforeLoad: function() {
                    $(window).unbind('resize');
                },
                onLoadSuccess: function(data) {
                    $.unblockUI();
                    $(window).bind("resize", function() {
                        $('#qryResultTb').datagrid("resize");

                        if (isNotBlank($('#tmpUserUuid').val())) {
                            $('#qryRolesResultTb').datagrid("resize");
                        }
                    });
                },
                //                onDblClickRow: function(rowIndex, rowData) { // doOpenNewWindow(rowData.UUID, rowData.USER_ACCOUNT); // },
                frozenColumns: [
                    [{
                        field: 'DRAFT_TYPE',
                        title: '上稿類型',
                        width: 100,
                        sortable: true,
                        halign: 'center',
                        align: 'left'
                    }, {
                        field: 'DRAFT_NAME',
                        title: '上稿名稱',
                        width: 350,
                        sortable: true,
                        halign: 'center',
                        align: 'left'
                    }]
                ],
                columns: [
                    [{
                            field: 'DRAFT_ID',
                            title: '上稿代號',
                            width: 100,
                            sortable: true,
                            halign: 'center',
                            align: 'left'
                        }, {
                            field: 'DRAFT_FTYPE',
                            title: '檔案型態',
                            width: 100,
                            sortable: true,
                            halign: 'center',
                            align: 'left'
                        }, {
                            field: 'VAILE_S_DATE',
                            title: '生效日期起',
                            width: 200,
                            sortable: true,
                            halign: 'center',
                            align: 'left'
                        }, {
                            field: 'VAILE_E_DATE',
                            title: '生效日期迄',
                            width: 200,
                            sortable: true,
                            halign: 'center',
                            align: 'left'
                        }, {
                            field: 'DRAFT_VERSION',
                            title: '版次',
                            width: 50,
                            sortable: true,
                            halign: 'center',
                            align: 'left'
                        },
                        {
                            field: 'UPDATE_USER',
                            title: '異動人員',
                            width: 100,
                            sortable: true,
                            halign: 'center',
                            align: 'left'
                        },
                        {
                            field: 'UPDATE_TIME',
                            title: '異動時間',
                            width: 200,
                            sortable: true,
                            halign: 'center',
                            align: 'left'
                        }
                    ]
                ],
                toolbar: [{
                        id: 'okBt',
                        text: '覆核',
                        iconCls: 'icon-ok',
                        handler: function() {
                            if ($('#qryResultTb').datagrid('getSelections').length < 1) {
                                alert('請選擇欲取消覆核的上稿資料!');
                                return;
                            }
                            alert2('覆核完成!');


                            $('#addRoleDiv').addClass('hide');
                            $('#qryRolesResultDiv').addClass('hide');
                        }
                    }, {
                        id: 'noBt',
                        text: '取消覆核',
                        iconCls: 'icon-no',
                        handler: function() {
                            if ($('#qryResultTb').datagrid('getSelections').length < 1) {
                                alert('請選擇欲取消覆核的上稿資料!');
                                return;
                            }

                            alert2('取消覆核完成!');

                            $('#addRoleDiv').addClass('hide');
                            $('#qryRolesResultDiv').addClass('hide');
                        }
                    },
                    {
                        id: 'previewBt',
                        text: '預覽上稿',
                        iconCls: 'icon-search',
                        handler: function() {
                            if ($('#qryResultTb').datagrid('getSelections').length < 1) {
                                alert('請選擇欲預覽的上稿資料!');
                                return;
                            }

                            var row = $('#qryResultTb').datagrid('getSelected');
                            doOpenNewWindow(row.UUID, row.USER_ACCOUNT);

                            $('#addRoleDiv').addClass('hide');
                            $('#qryRolesResultDiv').addClass('hide');
                        }
                    }
                ]
            });

            var user = {
                total: 2,
                rows: [{
                        DRAFT_TYPE: '套表型',
                        DRAFT_NAME: '問卷-NQB11',
                        DRAFT_ID: 'NQB11',
                        DRAFT_FTYPE: 'TXT',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '套表型',
                        DRAFT_NAME: '問卷-NQB12',
                        DRAFT_ID: 'NQB12',
                        DRAFT_FTYPE: 'TXT',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '套表型',
                        DRAFT_NAME: '問卷-NQB1C',
                        DRAFT_ID: 'NQB1C',
                        DRAFT_FTYPE: 'TXT',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '套表型',
                        DRAFT_NAME: '問卷-Q01',
                        DRAFT_ID: 'Q01',
                        DRAFT_FTYPE: 'TXT',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '套表型',
                        DRAFT_NAME: '問卷-Q05',
                        DRAFT_ID: 'Q05',
                        DRAFT_FTYPE: 'TXT',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '套表型',
                        DRAFT_NAME: '問卷-Q06',
                        DRAFT_ID: 'Q06',
                        DRAFT_FTYPE: 'TXT',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '套表型',
                        DRAFT_NAME: '問卷-Q10',
                        DRAFT_ID: 'Q10',
                        DRAFT_FTYPE: 'TXT',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '套表型',
                        DRAFT_NAME: '問卷-Q11',
                        DRAFT_ID: 'Q11',
                        DRAFT_FTYPE: 'TXT',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '套表型',
                        DRAFT_NAME: '問卷-Q12',
                        DRAFT_ID: 'Q12',
                        DRAFT_FTYPE: 'TXT',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '附件型',
                        DRAFT_NAME: '財務狀況告知書',
                        DRAFT_ID: '104',
                        DRAFT_FTYPE: 'PDF',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '附件型',
                        DRAFT_NAME: 'FATCA新契約問卷-個人用',
                        DRAFT_ID: '106',
                        DRAFT_FTYPE: 'PDF',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '附件型',
                        DRAFT_NAME: 'FATCA新契約問卷-法人用',
                        DRAFT_ID: '107',
                        DRAFT_FTYPE: 'PDF',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '附件型',
                        DRAFT_NAME: 'FATCA申報同意函-個人用',
                        DRAFT_ID: '108',
                        DRAFT_FTYPE: 'PDF',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '附件型',
                        DRAFT_NAME: 'FATCA申報同意函-法人用',
                        DRAFT_ID: '109',
                        DRAFT_FTYPE: 'PDF',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '附件型',
                        DRAFT_NAME: 'FATCA新契約(銀保專用)問卷暨申報同意函-個人用',
                        DRAFT_ID: '110',
                        DRAFT_FTYPE: 'PDF',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '附件型',
                        DRAFT_NAME: 'W表格-fw8exp',
                        DRAFT_ID: 'fw8exp',
                        DRAFT_FTYPE: 'PDF',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '附件型',
                        DRAFT_NAME: 'W表格-fw8imy',
                        DRAFT_ID: 'fw8imy',
                        DRAFT_FTYPE: 'PDF',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '附件型',
                        DRAFT_NAME: 'W表格-fw8benc',
                        DRAFT_ID: 'fw8benc',
                        DRAFT_FTYPE: 'PDF',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '附件型',
                        DRAFT_NAME: 'W表格-fw9',
                        DRAFT_ID: 'fw9',
                        DRAFT_FTYPE: 'PDF',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    },
                    {
                        DRAFT_TYPE: '附件型',
                        DRAFT_NAME: 'W表格-fw8bene',
                        DRAFT_ID: 'fw8bene',
                        DRAFT_FTYPE: 'PDF',
                        VAILE_S_DATE: '2017/01/01 00:00:00',
                        VAILE_E_DATE: '2017/12/31 23:59:59',
                        DRAFT_VERSION: '1',
                        UPDATE_USER: 'WHNBZ109',
                        UPDATE_TIME: '2017/05/11 17:35:26'
                    }
                ]
            };
            $('#qryResultTb').datagrid('loadData', user).datagrid('acceptChanges');

        }

        /**
         * 刪除使用者
         */
        function doDelUser(uuid, userAccount) {
            $.ajax({
                url: './F010001_SCN1.action?doDelUser',
                data: {
                    uuid: uuid,
                    userAccount: userAccount
                },
                type: 'POST',
                async: false,
                dataType: 'json',
                success: function(json) {
                    if (isNotBlank(json.msg)) {
                        alert(json.msg);
                    }

                    if (json.action == 'Y') {
                        alert('資料已刪除');
                        reloadTable();
                    }
                }
            });
        }

        /**
         * 開啟新頁面，執行新增/修改
         */
        function doOpenNewWindow(uuid, userAccount) {
            $('#newWindowForm input[name=uuid]').val(uuid);
            $('#newWindowForm input[name=userAccount]').val(userAccount);

            var winId = 'newWindow';
            newWindow = window.open('', winId, 'toolbar=no,resizable=yes,scrollbars=yes,location=no,addressbar=no');

            $('#newWindowForm').attr('target', winId);
            $('#newWindowForm').submit();

            newWindow.focus();
        }

        /**
         * 重新戴入表格資料
         */
        function reloadTable() {
            $('#qryResultTb').datagrid('reload');
        }

    </script>

</head>

<body onload="doQryUserList();">

    <script>
        // menu block -------------------------------------------------------
        menu.writeMenu();

    </script>

    <form id="form" action="/F000001_SCN1.action" role="form" method="post">
        <!-- -------------------------------------- 隱藏區 -------------------------------------- -->
        <input type="hidden" id="msg" name="msg" value="" />
        <input type="hidden" name="xxx" value="xxx" />
        <input type="hidden" id="tmpUserUuid" name="tmpUserUuid" />

        <!-- -------------------------------------- 查詢區 -------------------------------------- -->
        <stripes:errors />

        <div class="panel panel-default">
            <div class="panel-heading"><b>上稿功能</b></div>
            <div class="bootstrap-panel-body">
            </div>
        </div>

        <div id="qryResultDiv">
            <table id="qryResultTb"></table>
        </div>
        <br />

    </form>

    <form id="newWindowForm" name="newWindowForm" action="F040007_SCN2.html" method="post">
        <input type="hidden" name="xxxx" value="xxxxx" />
        <input type=hidden name="uuid" />
        <input type=hidden name="userAccount" />
    </form>

    <!-- -------------------------------------- 顯示區 -------------------------------------- -->

    <script>
        // footer block -------------------------------------------------------
        menu.writeFooter();

    </script>

</body>
